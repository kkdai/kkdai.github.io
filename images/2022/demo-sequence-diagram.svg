<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="848px" preserveAspectRatio="none" style="width:930px;height:848px;" version="1.1" viewBox="0 0 930 848" width="930px" zoomAndPan="magnify"><defs><filter height="300%" id="f1p684lscd9bn4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="36" x2="36" y1="65.2969" y2="775.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="329.5" x2="329.5" y1="65.2969" y2="775.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="654.5" x2="654.5" y1="65.2969" y2="775.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="900.5" x2="900.5" y1="65.2969" y2="775.0859"/><rect fill="#FEFECE" filter="url(#f1p684lscd9bn4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="8" y="30"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="15" y="49.9951">Client</text><rect fill="#FEFECE" filter="url(#f1p684lscd9bn4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="8" y="774.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="15" y="794.0811">Client</text><rect fill="#FEFECE" filter="url(#f1p684lscd9bn4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="298.5" y="30"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="305.5" y="49.9951">Server</text><rect fill="#FEFECE" filter="url(#f1p684lscd9bn4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="298.5" y="774.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="305.5" y="794.0811">Server</text><rect fill="#FEFECE" filter="url(#f1p684lscd9bn4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="623.5" y="30"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="630.5" y="49.9951">Library</text><rect fill="#FEFECE" filter="url(#f1p684lscd9bn4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="623.5" y="774.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="630.5" y="794.0811">Library</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="877.5" y="61.9951">Users</text><path d="M882.5,13 C882.5,3 900.5,3 900.5,3 C900.5,3 918.5,3 918.5,13 L918.5,39 C918.5,49 900.5,49 900.5,49 C900.5,49 882.5,49 882.5,39 L882.5,13 " fill="#FEFECE" filter="url(#f1p684lscd9bn4)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M882.5,13 C882.5,23 900.5,23 900.5,23 C900.5,23 918.5,23 918.5,13 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="877.5" y="787.0811">Users</text><path d="M882.5,800.3828 C882.5,790.3828 900.5,790.3828 900.5,790.3828 C900.5,790.3828 918.5,790.3828 918.5,800.3828 L918.5,826.3828 C918.5,836.3828 900.5,836.3828 900.5,836.3828 C900.5,836.3828 882.5,836.3828 882.5,826.3828 L882.5,800.3828 " fill="#FEFECE" filter="url(#f1p684lscd9bn4)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M882.5,800.3828 C882.5,810.3828 900.5,810.3828 900.5,810.3828 C900.5,810.3828 918.5,810.3828 918.5,800.3828 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#A80036" points="317.5,92.4297,327.5,96.4297,317.5,100.4297,321.5,96.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="323.5" y1="96.4297" y2="96.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="43.5" y="91.3638">1</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="56.5" y="92.5703">start(username?)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="329.5" x2="371.5" y1="125.5625" y2="125.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="371.5" x2="371.5" y1="125.5625" y2="138.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="330.5" x2="371.5" y1="138.5625" y2="138.5625"/><polygon fill="#A80036" points="340.5,134.5625,330.5,138.5625,340.5,142.5625,336.5,138.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="336.5" y="120.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="349.5" y="120.4966">Create userHandle?</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="329.5" x2="371.5" y1="167.6953" y2="167.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="371.5" x2="371.5" y1="167.6953" y2="180.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="330.5" x2="371.5" y1="180.6953" y2="180.6953"/><polygon fill="#A80036" points="340.5,176.6953,330.5,180.6953,340.5,184.6953,336.5,180.6953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="336.5" y="162.6294">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="349.5" y="162.6294">Verify password?</text><polygon fill="#A80036" points="642.5,205.8281,652.5,209.8281,642.5,213.8281,646.5,209.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="329.5" x2="648.5" y1="209.8281" y2="209.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="336.5" y="204.7622">4</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="349.5" y="205.9687">start(username?, userHandle?)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="654.5" x2="696.5" y1="238.9609" y2="238.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="696.5" x2="696.5" y1="238.9609" y2="251.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="655.5" x2="696.5" y1="251.9609" y2="251.9609"/><polygon fill="#A80036" points="665.5,247.9609,655.5,251.9609,665.5,255.9609,661.5,251.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="661.5" y="233.895">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="674.5" y="233.895">Generate challenge</text><polygon fill="#A80036" points="888.5,277.0938,898.5,281.0938,888.5,285.0938,892.5,281.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="654.5" x2="894.5" y1="281.0938" y2="281.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="661.5" y="276.0278">6</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="674.5" y="277.2343">listCredentials(username)</text><polygon fill="#A80036" points="665.5,306.2266,655.5,310.2266,665.5,314.2266,661.5,310.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="659.5" x2="899.5" y1="310.2266" y2="310.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="671.5" y="305.1606">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="684.5" y="305.1606">Credential IDs</text><polygon fill="#A80036" points="340.5,335.3594,330.5,339.3594,340.5,343.3594,336.5,339.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="334.5" x2="653.5" y1="339.3594" y2="339.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="346.5" y="334.2935">8</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="359.5" y="335.5">request: PublicKeyCredential*Options</text><polygon fill="#A80036" points="47.5,364.4922,37.5,368.4922,47.5,372.4922,43.5,368.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="328.5" y1="368.4922" y2="368.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="53.5" y="363.4263">9</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="66.5" y="364.6328">navigator.credentials.*(request)</text><polygon fill="#A80036" points="317.5,393.625,327.5,397.625,317.5,401.625,321.5,397.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="36.5" x2="323.5" y1="397.625" y2="397.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="43.5" y="392.5591">10</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="65.5" y="393.7656">response: PublicKeyCredential</text><polygon fill="#A80036" points="642.5,422.7578,652.5,426.7578,642.5,430.7578,646.5,426.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="329.5" x2="648.5" y1="426.7578" y2="426.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="336.5" y="421.6919">11</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="358.5" y="422.8984">finish(request, response)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="654.5" x2="696.5" y1="455.8906" y2="455.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="696.5" x2="696.5" y1="455.8906" y2="468.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="655.5" x2="696.5" y1="468.8906" y2="468.8906"/><polygon fill="#A80036" points="665.5,464.8906,655.5,468.8906,665.5,472.8906,661.5,468.8906" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="661.5" y="450.8247">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="683.5" y="450.8247">Validate</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="739.5" y="453.105">(request, response)</text><polygon fill="#A80036" points="888.5,494.0234,898.5,498.0234,888.5,502.0234,892.5,498.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="654.5" x2="894.5" y1="498.0234" y2="498.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="661.5" y="492.9575">13</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="683.5" y="494.164">getPublicKey(response.id)</text><polygon fill="#A80036" points="665.5,523.1563,655.5,527.1563,665.5,531.1563,661.5,527.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="659.5" x2="899.5" y1="527.1563" y2="527.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="671.5" y="522.0903">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="693.5" y="522.0903">Public key</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="654.5" x2="696.5" y1="556.2891" y2="556.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="696.5" x2="696.5" y1="556.2891" y2="569.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="655.5" x2="696.5" y1="569.2891" y2="569.2891"/><polygon fill="#A80036" points="665.5,565.2891,655.5,569.2891,665.5,573.2891,661.5,569.2891" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="661.5" y="551.2231">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="683.5" y="551.2231">Verify</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="723.5" y="553.5034">response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="791.5" y="551.2231">signature</text><polygon fill="#A80036" points="340.5,594.4219,330.5,598.4219,340.5,602.4219,336.5,598.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="334.5" x2="653.5" y1="598.4219" y2="598.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="346.5" y="593.356">16</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="368.5" y="594.5625">result: Result</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="329.5" x2="371.5" y1="627.5547" y2="627.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="371.5" x2="371.5" y1="627.5547" y2="640.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="330.5" x2="371.5" y1="640.5547" y2="640.5547"/><polygon fill="#A80036" points="340.5,636.5547,330.5,640.5547,340.5,644.5547,336.5,640.5547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="336.5" y="622.4888">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="358.5" y="622.4888">Inspect</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="408.5" y="624.7691">result</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="42.5" x2="52.5" y1="664.6875" y2="674.6875"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="42.5" x2="52.5" y1="674.6875" y2="664.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48.5" x2="328.5" y1="669.6875" y2="669.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="53.5" y="664.6216">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="75.5" y="664.6216">Report failure?</text><polygon fill="#A80036" points="888.5,694.8203,898.5,698.8203,888.5,702.8203,892.5,698.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="329.5" x2="894.5" y1="698.8203" y2="698.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="336.5" y="693.7544">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="358.5" y="693.7544">Store new credential?</text><polygon fill="#A80036" points="888.5,723.9531,898.5,727.9531,888.5,731.9531,892.5,727.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="329.5" x2="894.5" y1="727.9531" y2="727.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="336.5" y="722.8872">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="358.5" y="722.8872">Update signature count?</text><ellipse cx="36" cy="756.3359" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#A80036" points="53,753.0859,43,757.0859,53,761.0859,49,757.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="51" x2="328.5" y1="757.0859" y2="757.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="53.5" y="752.02">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="75.5" y="752.02">Report success?</text><!--
@startuml

participant Client
participant Server
participant Library
database Users
autonumber

Client -> Server: ""start(username?)""
Server -> Server: Create userHandle?
Server -> Server: Verify password?
Server -> Library: ""start(username?, userHandle?)""
Library -> Library: Generate challenge
Library -> Users: ""listCredentials(username)""
Users - -> Library: Credential IDs
Library - -> Server: ""request: PublicKeyCredential*Options""
Server -> Client: ""navigator.credentials.*(request)""
Client - -> Server: ""response: PublicKeyCredential""
Server -> Library: ""finish(request, response)""
Library -> Library: Validate ""(request, response)""
Library -> Users: ""getPublicKey(response.id)""
Users - -> Library: Public key
Library -> Library: Verify ""response"" signature
Library - -> Server: ""result: Result""
Server -> Server: Inspect ""result""
Server ->x Client: Report failure?
Server -> Users: Store new credential?
Server -> Users: Update signature count?
Server ->o Client: Report success?
@enduml

PlantUML version 1.2019.00(Sun Jan 13 15:46:42 UTC 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>