<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>{{ page.title }}</title>
	{% if page.description %}
	<meta name="description" content="{{ page.description }}">
	{% endif %}
	<meta name="author" content="{{ site.author.name }}">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Open Graph meta tags -->
	<meta property="og:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
	<meta property="og:description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
	<meta property="og:url" content="{{ site.BASE_PATH }}{% if page.url %}{{ page.url }}{% else %}/{% endif %}">
	<meta property="og:site_name" content="{{ site.title }}">
	<meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
	{% if page.layout == 'post' and page.date %}
	<meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
	<meta property="article:author" content="{{ site.author.name }}">
	{% endif %}
	{% if page.tags %}
	{% for tag in page.tags %}
	<meta property="article:tag" content="{{ tag }}">
	{% endfor %}
	{% endif %}

	<!-- Twitter Card meta tags -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
	<meta name="twitter:description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
	{% if site.author.twitter %}
	<meta name="twitter:site" content="@{{ site.author.twitter }}">
	<meta name="twitter:creator" content="@{{ site.author.twitter }}">
	{% endif %}

	<!-- SEO meta tags -->
	<link rel="canonical" href="{{ site.BASE_PATH }}{% if page.url %}{{ page.url }}{% else %}/{% endif %}">
	<meta name="robots" content="index, follow">
	<meta name="theme-color" content="#2c3e50">
	{% if page.layout == 'post' %}
	<meta name="article:publisher" content="{{ site.BASE_PATH }}">
	{% endif %}
	<meta name="format-detection" content="telephone=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<link href="{{ site.BASE_PATH }}/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="{{ site.BASE_PATH }}/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="{{ site.BASE_PATH }}/assets/css/style.css" rel="stylesheet">

	<!-- Mobile Touch Optimization -->
	<style>
		/* Touch-friendly button sizes */
		.btn {
			min-height: 44px;
			min-width: 44px;
		}
		
		/* Better touch targets for navigation */
		.nav-link {
			padding: 0.75rem 1rem;
			min-height: 44px;
			display: flex;
			align-items: center;
		}
		
		.dropdown-item {
			padding: 0.75rem 1.5rem;
			min-height: 44px;
			display: flex;
			align-items: center;
		}
		
		/* Improved spacing for mobile */
		@media (max-width: 991.98px) {
			.navbar-nav .nav-item {
				margin-bottom: 0.25rem;
			}
			
			.navbar-brand {
				padding: 0.75rem 0;
			}
			
			body {
				padding-top: 0;
			}
			
			.col-lg-9 {
				padding: 1rem;
			}
		}
		
		/* Better scrolling on mobile */
		html {
			scroll-behavior: smooth;
			-webkit-overflow-scrolling: touch;
		}
	</style>

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="{{ site.name }}" href="{{ site.BASE_PATH }}/feed.xml">
	
	<!-- Google AdSense -->
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9782028920809175"
	     crossorigin="anonymous"></script>

	<!-- Structured Data (JSON-LD) -->
	<script type="application/ld+json">
	{
		"@context": "https://schema.org",
		{% if page.layout == 'post' %}
		"@type": "BlogPosting",
		"headline": "{{ page.title | escape }}",
		"description": "{% if page.description %}{{ page.description | escape }}{% else %}{{ page.title | escape }}{% endif %}",
		"author": {
			"@type": "Person",
			"name": "{{ site.author.name }}",
			"url": "{{ site.BASE_PATH }}"
		},
		"publisher": {
			"@type": "Organization",
			"name": "{{ site.title }}",
			"logo": {
				"@type": "ImageObject",
				"url": "http://www.gravatar.com/avatar/{{site.author.email_md5}}?s=200"
			}
		},
		"datePublished": "{{ page.date | date_to_xmlschema }}",
		"dateModified": "{{ page.date | date_to_xmlschema }}",
		"url": "{{ site.BASE_PATH }}{{ page.url }}",
		"mainEntityOfPage": {
			"@type": "WebPage",
			"@id": "{{ site.BASE_PATH }}{{ page.url }}"
		}
		{% else %}
		"@type": "WebSite",
		"name": "{{ site.title }}",
		"description": "{{ site.description }}",
		"url": "{{ site.BASE_PATH }}",
		"author": {
			"@type": "Person",
			"name": "{{ site.author.name }}"
		}
		{% endif %}
	}
	</script>
</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-light bg-light d-lg-none" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mobileNavbar" aria-controls="mobileNavbar" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			{% if site.author.github %}
			<a class="btn btn-outline-secondary btn-sm me-2" href="http://github.com/{{ site.author.github }}" aria-label="GitHub">
				<i class="fa fa-github"></i>
			</a>
			{% endif %}
			{% if site.author.twitter %}
			<a class="btn btn-outline-secondary btn-sm me-2" href="http://twitter.com/{{ site.author.twitter }}" aria-label="Twitter">
				<i class="fa fa-twitter"></i>
			</a>
			{% endif %}
			{% if site.author.email %}
			<a class="btn btn-outline-secondary btn-sm" href="mailto:{{ site.author.email }}" aria-label="Email">
				<i class="fa fa-envelope"></i>
			</a>
			{% endif %}
			<a class="navbar-brand d-flex align-items-center" href="{{ site.BASE_PATH }}/">
				<img src="http://www.gravatar.com/avatar/{{site.author.email_md5}}?s=35" class="rounded-circle me-2" alt="{{ site.author.name }}" />
				{{ site.title }}
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="mobileNavbar">
			<ul class="navbar-nav me-auto mb-2 mb-lg-0">
				<li class="nav-item"><a class="nav-link active" href="{{ site.BASE_PATH }}/">首頁</a></li>
				<li class="nav-item"><a class="nav-link" href="{{ site.BASE_PATH}}/{{ site.categories_path }}">分類</a></li>
				<li class="nav-item"><a class="nav-link" href="{{ site.BASE_PATH}}/{{ site.archive_path }}">封存</a></li>
				<li class="nav-item"><a class="nav-link" href="{{ site.BASE_PATH}}/{{ site.tags_path }}">標籤</a></li>
				<li class="nav-item"><a class="nav-link" href="{{ site.BASE_PATH}}/about/">關於我</a></li>
				<li class="nav-item"><a class="nav-link" href="{{ site.BASE_PATH}}/privacy/">隱私權政策</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
                	  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
                        	  });
	</script>

	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>

	<!-- nav-menu-dropdown -->
	<div class="btn-group d-none d-lg-block" id="nav-menu">
		<button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu">
			<li><a class="dropdown-item" href="{{ site.BASE_PATH}}/"><i class="fa fa-home"></i> 首頁</a></li>
			<li><a class="dropdown-item" href="{{ site.BASE_PATH}}/{{ site.categories_path }}"><i class="fa fa-folder"></i> 分類</a></li>
			<li><a class="dropdown-item" href="{{ site.BASE_PATH}}/{{ site.archive_path }}"><i class="fa fa-archive"></i> 封存</a></li>
			<li><a class="dropdown-item" href="{{ site.BASE_PATH}}/{{ site.tags_path }}"><i class="fa fa-tags"></i> 標籤</a></li>
			<li><hr class="dropdown-divider"></li>
			<li><a class="dropdown-item" href="{{ site.BASE_PATH}}/about/"><i class="fa fa-user"></i> 關於我</a></li>
			<li><a class="dropdown-item" href="{{ site.BASE_PATH}}/privacy/"><i class="fa fa-shield"></i> 隱私權政策</a></li>
			<li><a class="dropdown-item" href="{{ site.BASE_PATH}}/contact/"><i class="fa fa-envelope"></i> 聯絡我</a></li>
			<li><hr class="dropdown-divider"></li>
			<li><a class="dropdown-item" href="#"><i class="fa fa-arrow-up"></i> 回到頁首</a></li>
		</ul>
	</div>

	<div class="col-lg-3 sidebar d-none d-lg-block"
		style="{% if site.sidebar_background_image %}background: url({{site.sidebar_background_image}}) no-repeat center center !important;{% endif %}">
		{% include sidebar.html %}
	</div>

	<div class="col-lg-9 offset-lg-3">
		{{ content }}

		<footer>
			<hr />
			<p>
				&copy; {{ site.time | date: '%Y' }} {{ site.author.name }} with Jekyll. Theme: <a
					href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript"
		src="{{ site.BASE_PATH }}/assets/resources/jquery/jquery-migrate-3.4.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
	<script type="text/javascript" src="{{ site.BASE_PATH }}/assets/js/app.js"></script>

	<!-- Lazy Loading for Images -->
	<script>
		// Native lazy loading fallback for older browsers
		if ('loading' in HTMLImageElement.prototype) {
			// Native lazy loading is supported
			document.querySelectorAll('img[data-src]').forEach(img => {
				img.src = img.dataset.src;
				img.removeAttribute('data-src');
				img.setAttribute('loading', 'lazy');
			});
		} else {
			// Fallback for older browsers using Intersection Observer
			const imageObserver = new IntersectionObserver((entries, observer) => {
				entries.forEach(entry => {
					if (entry.isIntersecting) {
						const img = entry.target;
						img.src = img.dataset.src;
						img.removeAttribute('data-src');
						imageObserver.unobserve(img);
					}
				});
			});

			document.querySelectorAll('img[data-src]').forEach(img => {
				imageObserver.observe(img);
			});
		}

		// Add loading="lazy" to all images without it
		document.addEventListener('DOMContentLoaded', function() {
			document.querySelectorAll('img:not([loading])').forEach(img => {
				img.setAttribute('loading', 'lazy');
			});
		});
	</script>
</body>

</html>