---
layout: post
layout: post
author: kkdai
comments: true
date: 2004-07-02 14:42:16+00:00
slug: vc%e5%bf%83%e5%be%97%e5%88%a9%e7%94%a8vc%e6%96%b0%e5%a2%9e%e4%b8%80%e5%80%8b%e8%b3%87%e6%96%99%e5%a4%be%e9%81%b8%e9%a0%85%e4%b8%ad%e7%9a%84%e6%aa%94%e6%a1%88%e9%a1%9e%e5%9e%8b%e4%b8%80
title: '[VC心得]利用VC新增一個[資料夾選項]中的[檔案類型](一)'
wordpress_id: 111
categories:
- VC++程式設計
---

**_前言：_**

這篇文章主要是利用VC教導修改Registry中[HKEY_CLASSES_ROOT]中的新增一個檔案類型，也就是當你在檔案管理員中按下[工具]-->[資料夾選項]->[檔案類型]。在這裡會有相當多的檔案類型會出現，並且會有個別的ICON（圖示）也就是我們在檔案管理員下會看到的特別圖示（比如說：ZIP是一個壓縮檔的圖案）。而現在就是告訴各位，如何利用VC撰寫一個可以新增一個檔案類型，並且指定好開檔類型與檔名顯示的方法。


<!-- more -->


**_修改原理：_**

在這裡，先教導大家關於這個程式的一些原理所在。首先，我們都知道在[開始功能表]->[執行]打上regedit，是可以開啟[登錄編輯程式]的，在這裡要為大家稍微介紹一下，登錄編輯程式裡面參數的介紹，在Registry裡面有五個主要參數，在這裡HKEY_CLASSES_ROOT裡面主要就是存放我們所提到的[檔案類型]的相關資料，將這個參數展開，一開始會是一堆的附檔名為首的變數（*~.1~.aXX~.ZXX)

想要在[工具]-->[資料夾選項]->[檔案類型]裡面去新增一個檔案類型，可以按下[新增]，設定好一個附檔名（Extension Name)，並且選取好相關應用程式與對應的參數（比如說 OPEN～～），還有對應的ICON圖形。

若要在REGISTRY中設定，與[工具]-->[資料夾選項]->[檔案類型]->[新增]有相同的作用，而這裡的變數具有一定的對照關係。要增加一個新的檔案類型，依照以下步驟去建立：

  * 首先你必須要設定好一個新的附檔名（EX：.ZZD），也就是建立一個機碼
  * 在該機碼上給定一個字串值（default ==> FoolProductID)，也就是你自己隨便取的類別ID。
  * _建立另外一個相對應的機碼，名稱為FoolProductID，並且在其中寫下字串值，（default ==> Fool_Name)，_
  * 若想要設定相關的ICON圖形，則必須在其中再設定一個子機碼，名稱為DefaultIcon，並在內寫下一個字串值（default ==> Fool_Icon_Address)，在此Fool_Icon_Address是由某些程式產生出來的，比如說%System/notepad.exe,1

下一次在介紹，相關指令與程式的全貌～～～

#Debug 去～～～～～
